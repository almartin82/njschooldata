% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/recover_graduation.R
\name{validate_grate_aggregation}
\alias{validate_grate_aggregation}
\title{Validate graduation rate aggregation}
\usage{
validate_grate_aggregation(df, tolerance = 2, log_dir = tempdir())
}
\arguments{
\item{df}{Graduation rate data frame with both school and district level data}

\item{tolerance}{Maximum allowed difference (in percentage points) between
reported district rate and calculated rate. Default is 2 (2 percentage points).}

\item{log_dir}{Directory for log files. Default is tempdir().}
}
\value{
Data frame with validation columns added:
  - `calculated_from_schools`: Rate calculated from school-level data
  - `rate_discrepancy_pp`: Difference in percentage points
  - `aggregation_flag`: "OK", "DISCREPANCY", "MISSING_SCHOOL_DATA", or "SUPPRESSED"
}
\description{
Compares district-level graduation rates against weighted averages calculated
from school-level data. Flags discrepancies that exceed a threshold, which
may indicate data quality issues in the source files.
}
\details{
This function helps identify potential data quality issues where:
- District totals don't match sum of school data
- Rates are mathematically inconsistent
- Data may have been incorrectly entered or processed

A detailed log file is written documenting all discrepancies found.
}
