% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/percentile_rank.R
\name{calculate_subgroup_gap}
\alias{calculate_subgroup_gap}
\title{Calculate achievement gap between two subgroups}
\usage{
calculate_subgroup_gap(
  df,
  metric_col,
  subgroup_a,
  subgroup_b,
  year_col = "end_year",
  entity_cols = "district_id"
)
}
\arguments{
\item{df}{Dataframe with a 'subgroup' column and the metric of interest}

\item{metric_col}{Character. The column containing the metric to compare.}

\item{subgroup_a}{Character. The reference subgroup (typically majority/advantaged).}

\item{subgroup_b}{Character. The comparison subgroup (typically minority/disadvantaged).}

\item{year_col}{Character. Year column name. Default "end_year".}

\item{entity_cols}{Character vector. Columns identifying the entity
(e.g., c("district_id") or c("county_id", "district_id", "school_id")).}
}
\value{
Dataframe with one row per entity-year containing:
  \itemize{
    \item Original entity and year columns
    \item \code{{metric}_a}: Value for subgroup_a
    \item \code{{metric}_b}: Value for subgroup_b
    \item \code{{metric}_gap}: Absolute gap (a - b)
    \item \code{{metric}_gap_pct}: Relative gap as percent of subgroup_a
  }
}
\description{
Calculates the difference in a metric between two subgroups
within each entity (district/school) and year. The gap is calculated as
subgroup_a - subgroup_b, so positive values mean subgroup_a outperforms.
}
\examples{
\dontrun{
# Calculate Black-White graduation rate gap
grate \%>\%
  filter(subgroup \%in\% c("white", "black")) \%>\%
  calculate_subgroup_gap(
    metric_col = "grad_rate",
    subgroup_a = "white",
    subgroup_b = "black"
  )
}

}
