% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fetch_staff.R
\name{analyze_retention_patterns}
\alias{analyze_retention_patterns}
\title{Analyze Staff Retention Patterns}
\usage{
analyze_retention_patterns(df_list, by_subgroup = TRUE)
}
\arguments{
\item{df_list}{A named list of data frames from different years. Each element
should be named by its end_year (e.g., list("2022" = df_2022, "2024" = df_2024)).
Data frames should be from \code{\link{fetch_staff_retention}} or similar
containing staff retention data.}

\item{by_subgroup}{Logical; if TRUE (default), analyze retention patterns
by demographic subgroups. If FALSE, aggregate across all staff.}
}
\value{
Data frame with:
  \itemize{
    \item year - Year identifier
    \item location_id - Combined location identifier
    \item subgroup - Demographic subgroup (if by_subgroup = TRUE)
    \item retention_rate - Percentage of staff who returned from previous year
    \item turnover_rate - Percentage of new staff in current year
    \item stability_index - Composite score combining retention and turnover (0-100)
    \item trend - Trend classification: "improving", "stable", "declining", or "insufficient_data"
  }
}
\description{
Analyzes staff retention patterns across multiple years and demographic subgroups.
Calculates retention rates, turnover rates, and stability indices with trend detection.
}
\details{
The stability index is calculated as:
\deqn{stability = (retention_rate + (100 - turnover_rate)) / 2}

Higher values indicate greater staff stability (retained staff + low turnover).

Trend classification uses linear regression on multi-year stability scores:
\itemize{
  \item improving - Positive slope (stability increasing over time)
  \item stable - Near-zero slope or insufficient data
  \item declining - Negative slope (stability decreasing over time)
}
}
\examples{
\dontrun{
# Fetch retention data for multiple years
retain_2022 <- fetch_staff_retention(2022)
retain_2023 <- fetch_staff_retention(2023)
retain_2024 <- fetch_staff_retention(2024)

# Combine into named list
df_list <- list(
  "2022" = retain_2022,
  "2023" = retain_2023,
  "2024" = retain_2024
)

# Analyze overall retention patterns
overall_patterns <- analyze_retention_patterns(df_list, by_subgroup = FALSE)

# Analyze by demographic subgroup
subgroup_patterns <- analyze_retention_patterns(df_list, by_subgroup = TRUE)

# View schools with declining retention
subgroup_patterns \%>\%
  dplyr::filter(trend == "declining") \%>\%
  dplyr::select(school_name, year, subgroup, retention_rate, trend)
}
}
